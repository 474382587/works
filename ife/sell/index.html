<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .hide {
            display: none;
        }

        table {
            border-collapse: collapse;
        }

        td {
            padding: 10px;
            border: 1px solid black;

        }

        tbody:hover td[rowspan='3'] {
            background-color: rgb(193, 255, 187);
        }

        .row:hover {
            background-color: rgb(193, 255, 187);
        }

        .flex {
            display: flex;
            justify-content: space-around;
        }
    </style>
</head>

<body>
    <div id="selections">
        <div id="container1"></div>
        <div id="container2"></div>
    </div>
    <div id="table-container">

    </div>
    <div class="flex">
        <div id="svg-container">

        </div>
        <div id="canvas-container">

        </div>
    </div>

    <script src="checkbox.js"></script>
    <script src="sourceData.js"></script>
    <script src="filter.js"></script>
    <script src="table.js"></script>
    <script src="barchart.js"></script>
    <script src="linechart.js"></script>

    <script>
        const selections = document.getElementById("selections");
        const container2 = document.getElementById("container2")
        const container1 = document.getElementById("container1")
        const tables = document.getElementById("table-container")
        const svgContainer = document.getElementById("svg-container");
        const canvasContainer = document.getElementById("canvas-container");
        // 创建两个选择
        // 1 
        var product = new Checkbox(container1, [{
            value: "全部",
            name: "全部"
        }, {
            value: "手机",
            name: "手机"
        }, {
            value: "笔记本",
            name: "笔记本"
        }, {
            value: "智能音箱",
            name: "智能音箱"
        }], "product");
        var region = new Checkbox(container2, [{
            value: "全部",
            name: "全部"
        }, {
            value: "华东",
            name: "华东"
        }, {
            value: "华北",
            name: "华北"
        }, {
            value: "华南",
            name: "华南"
        }], "region");

        // initialize()
        // function initialize() {
        //     let data = sourceData;
        //     let params = {
        //         product: product.getValue(),
        //         region: region.getValue()
        //     }
        //     let filter = new Filter(data, params);
        //     console.log(filter.filterAll());
        // }
        selections.addEventListener("change", e => {
            //每当发生变化时 获取值
            let data = sourceData;
            let params = {
                product: product.getValue(),
                region: region.getValue()
            }
            // console.log(data)
            // console.log(params)
            let filter = new Filter(data, params);
            // console.log(filter);
            console.log(filter.filterAll());
            let processedData = filter.filterAll()
            let table = new Table(processedData);
            table.createTableHead();
            tables.innerHTML = "";
            tables.appendChild(table.createTable())


            //event listener when hover
            let rows = document.querySelectorAll(".row");
            rows.forEach(e => {
                e.addEventListener("mouseenter", event => {
                    let arr = Array.from(event.target.querySelectorAll("td"));
                    let arr1 = arr.map(e => e.textContent)
                    let arr2 = arr.map(e => e.textContent)
                    //bar chart
                    svgContainer.innerHTML = "";
                    let barchart = new Barchart(arr1);
                    svgContainer.appendChild(barchart.createChart());
                    canvasContainer.innerHTML = "";
                    let lineChart = new Linechart(arr2);
                    canvasContainer.appendChild(lineChart.createLineChart())
                })
            });


            // let line

        })



    </script>

</body>

</html>